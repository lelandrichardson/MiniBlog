"use strict";(function(n,t,i){var r=function(){var t={S:"string",D:"double",I:"int",B:"bool"};return function(i){var r=this;return i=i||{},r.name=n.observable(i.name||""),r.description=n.observable(i.description||""),r.type=n.observable(i.type||"S"),r.value=n.observable(i.value||""),r.displayType=n.dependentObservable(function(){return t[r.type()]}),r.dirtyFlag=n.dirtyFlag(r),r.isValid=n.dependentObservable(function(){return r.name().length>0&&r.description().length>0&&t.hasOwnProperty(r.type())&&r.value().length>0}),r}}(),u=function(i){var u=this;return i=i||{},u.settings=n.observableArray([]),u.newSetting=n.observable(new r),u.load=function(){t.getJSON("/ajax/settings/list",function(n){var i=u.settings();i.push.apply(i,t.map(n,function(n){return new r(n)})),u.settings.valueHasMutated()})},u.update=function(n){t.ajax({url:"/ajax/settings/update",type:"POST",contentType:"application/json",processData:!1,data:JSON.stringify({method:"update",data:{name:n.name(),type:n.type(),value:n.value()}}),success:function(t){t&&t.success&&n.dirtyFlag.reset()}})},u.remove=function(n){confirm("Are you sure you want to delete {0}? This cannot be undone.".format(n.name()))&&t.get("/ajax/settings/remove?name={0}".format(n.name()),function(t){t&&u.settings.remove(n)})},u.addSetting=function(){t.ajax({url:"/ajax/settings/insert",type:"POST",contentType:"application/json",processData:!1,data:JSON.stringify({method:"update",data:{name:u.newSetting().name(),type:u.newSetting().type(),description:u.newSetting().description(),value:u.newSetting().value()}}),success:function(n){n&&n.success&&(u.newSetting().dirtyFlag.reset(),u.settings.push(u.newSetting()),u.newSetting(new r))}})},u.refreshCache=function(){t.get("/ajax/settings/flush",function(n){n&&alert(JSON.stringify(n))})},u};i.viewModel=new u,i.viewModel.load(),n.applyBindings(i.viewModel)})(ko,jQuery,window)